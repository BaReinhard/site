---
layout: null
classname: "map map-list"

stylesheets:
  - "https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.css"

categories:
    free:
        headline: Free food
        link_label: Food Pantries
    grow:
        headline: Grow food
        link_label: Community Gardens
    purchase:
        headline: Food for sale
        link_label: Farmers’ Markets
---

<!doctype html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8" />
	<title>List</title>

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Reem+Kufi|Open+Sans:400,400i" />
	{% comment %}
	* Open Sans - Regular
	* Open Sans - Italic
	* Reem Kufi - Regular

	You can choose more faces here:
	https://fonts.google.com/selection?selection.family=Open+Sans:400,400i|Reem+Kufi
	{% endcomment %}
	<link href="https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.css" rel="stylesheet" />
	<link href="/assets/css/beta.css" rel="stylesheet" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>

<header>

	<h2><a href="/"><img src="/assets/images/fola.svg" alt="Food Oasis Los Angeles" /></a></h2>
	<p>Healthy Food for All Angelenos</p>

	<p class="action"><a href="/#navigation">Menu</a></p>

</header>

<nav>
	<p>
		<a href="/search/" id="search-link">
			<img src="/assets/images/icons/search-black.svg" width="50" alt="Search" />
			<span id="search-type">{{ page.category }}</span> <span id="search-location">Near <em>Los Angeles</em></span>
		</a>
	</p>

	<ul class="options action secondary" id="search-views">
		<li><a href="/filters/" id="filters-link">Filters</a></li>
	</ul>

	<script type="text/template" id="search-views-template">
		<li class="list" style="display: none;"><button type="button">List</button></li>
		<li class="map" style="display: none;"><button type="button">Map</button></li>
	</script>

	<script>
	(function() {
		// http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#answer-901144	
		function getParameterByName(name, url) {
			if (!url) url = window.location.href;
			name = name.replace(/[\[\]]/g, "\\$&");
			var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
					results = regex.exec(url);
			if (!results) return null;
			if (!results[2]) return '';
			return decodeURIComponent(results[2].replace(/\+/g, " "));
		}

		// SHIM: Make the type persistent
		var type = getParameterByName('type') {% if page.category and page.category != 'Healthy Food' %}|| '{{ page.collection }}'{% endif %};

		var address = getParameterByName('address');

		function updateLink(link) {
			var params = [];
			if (type) params.push('type=' + type);
			if (address) params.push('address=' + address);

			var queryString = params.join('&');
			link.setAttribute('href', link.getAttribute('href') + '?' + queryString);
		}

		if (type || address) {
			var filtersLink = document.getElementById('filters-link');
			if (filtersLink) {
				updateLink(filtersLink);
			}

			var searchLink = document.getElementById('search-link');
			if (searchLink) {
				updateLink(searchLink);
			}
		}

		if (type) {
			var types = type.split('|');

			var searchType = document.getElementById('search-type');

			if (types.length === 1) {
				// SHIM: Translate to a human readable version of the “type”.
				searchType.innerText = (types[0] === 'food-pantry') ? 'food pantries' : types[0].replace(/\-/g, ' ') + 's';
				searchType.style.textTransform = 'capitalize';
			} else {
				searchType.innerText = 'healthy food';
				searchType.style.textTransform = 'capitalize';
			}

		}
	})();

	(function() {
		var views = document.getElementById('search-views');
		var template = document.getElementById('search-views-template');
		views.insertAdjacentHTML('afterbegin', template.innerHTML);

		var mapButton = views.querySelector('.map');
		var listButton = views.querySelector('.list');

		listButton.style.display = "block";

		document.body.classList.add('only-map');
		document.body.classList.remove('only-list');

		mapButton.addEventListener('click', function(e) {
			mapButton.style.display = "none";
			listButton.style.display = "block";

			document.body.classList.add('only-map');
			document.body.classList.remove('only-list');
		}, false);

		listButton.addEventListener('click', function(e) {
			mapButton.style.display = "block";
			listButton.style.display = "none";

			document.body.classList.remove('only-map');
			document.body.classList.add('only-list');
		}, false);
	})();
	</script>
</nav>

<div id="map" class="map-container"></div>

<main>

<!--
	<script type="text/template" id="larger-map-template">
		<p class="larger-map"><button>Larger Map</button></p>
	</script>
-->

	<ul class="list" id="locations">
	{% if page.collection %}

		{% assign data_collection = site.collections | where: "label", page.collection | first %}
		{% assign data_list = data_collection.docs %}
		{% assign list_limit = page.items_per_page %}
		{% assign list_offset = page.list_offset %}
		{% include list.html %}

	{% else %}

		{% assign data_list = site.data['generated-locations-for-jekyll'] %}

		{% assign list_limit = page.items_per_page %}
		{% assign list_offset = page.list_offset %}
		{% include list.html %}

	{% endif %}
	</ul>

</main>

{% if page.next or page.previous %}
<nav class="pagination">
	<ul class="options action">
		{% if page.next %}
		<li><a href="{{ page.next }}">More Locations</a></li>
		{% endif %}
{% comment %}
		{% if page.previous %}
		<li><a href="{{ page.previous }}">Previous Page</a></li>
		{% endif %}
{% endcomment %}
	</ul>
</nav>
<script>
(function() {

	// http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#answer-901144	
	function getParameterByName(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, "\\$&");
		var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
				results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, " "));
	}

	// SHIM: Make the address persistent
	var paginationLink = document.querySelector('.pagination a[href]');
	var address = getParameterByName('address');
	if (address) {
		var href = paginationLink.getAttribute('href');
		href += '?address=' + address;
		paginationLink.setAttribute('href', href);
	}
})();
</script>
{% endif %}

<!-- For location-list.js -->
<script type="text/template" id="you-are-here-template">
	<div class="you-are-here"><span>You are here</span></div>
</script>

<script type="text/template" id="popup-template">
	<div class="map-point-details">
		<h3><a href=""></a></h3>
		<p class="type"></p>
		<p class="address"></p>
		<p class="phone"></p>
		<h4>Hours</h4>
		<p class="hours"></p>
		<p class="distance"><span></span> miles away</p>
	</div>
</script>

<script type="text/template" id="list-item-template">
	<a href="">
		<img src="" width="100" style="width: auto; height: 1.5em; border-radius: 50%; vertical-align: middle; margin-right: 0.375em; padding: 0.375em; background: rgb(153, 153, 153)" alt="" />
		<h2></h2>
		<p class="address"></p>
		<p class="type"></p>
		<p class="open"><del>Open Now <mark>Unknown Hours</mark></del></p>
		<p class="distance"><span></span> miles away</p>
	</a>
</script>

<!-- Jim’s Google Maps API key -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBP5KxqO9v1sLhXlkrG3vDiDdOJvYLJ0H4"></script>

<script src='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.js'></script>

<script>
var MAP_ACCESS_TOKEN = 'pk.eyJ1IjoiZm9vZG9hc2lzbGEiLCJhIjoiY2l0ZjdudnN4MDhpYzJvbXlpb3IyOHg2OSJ9.POBdqXF5EIsGwfEzCm8Y3Q';
</script>

<script>
var itemsPerPage = {{ page.items_per_page }};
var listOffset = {{ page.list_offset }};
</script>

{% if page.collection %}
<script src="/api/{{ page.collection }}.js"></script>
{% else %}
<script src="/api/locations.js"></script>
{% endif %}

<script src="/assets/js/location-list.js"></script>

</body>
</html>
